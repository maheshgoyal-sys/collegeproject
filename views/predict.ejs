<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RankToCollege - Smart College Predictor</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .faq-answer { display: none; }
    .faq-item.open .faq-answer { display: block; }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-white to-blue-100 min-h-screen text-gray-900">
  <!-- Navbar -->
  <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-4 py-4 flex justify-between items-center">
      <div class="flex items-center space-x-3">
        <img src="../images/CollegePredictor.png" alt="Logo" class="h-12 w-12 object-contain" />
        <a href="/" class="text-4xl font-bold text-blue-600">RankToCollege</a>
      </div>
      <div class="hidden md:flex items-center space-x-6">
        <a href="/" class="hover:text-blue-600">Home</a>
        <a href="/predict" class="text-gray-800 px-4 py-2 rounded transition-transform transform hover:scale-110 hover:shadow-md hover:shadow-blue-500/40 hover:text-blue-700 duration-300">Predict</a>
        <a href="/about" class="hover:text-blue-600">About</a>
        <a href="/contact" class="hover:text-blue-600">Contact</a>
      </div>
      <div class="hidden md:flex space-x-3">
        <% if (isAuthenticated) { %>
          <span class="text-gray-800 font-medium mt-2">Welcome, <%= userName ? userName.split('@')[0] : 'User' %>!</span>
          <a href="/logout" class="bg-red-600 text-white px-2 py-2 rounded-lg hover:bg-red-700">Logout</a>
        <% } else { %>
          <a href="/login" class="text-blue-600 font-medium mt-2 hover:underline">Sign In</a>
          <a href="/register" class="bg-blue-600 text-white px-2 py-2 rounded-lg hover:bg-blue-700">Sign Up</a>
        <% } %>
      </div>
      <button class="md:hidden" id="nav-toggle">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </div>
  </nav>

  <!-- Main Card Section -->
  <main class="max-w-2xl mx-auto mt-10 px-4">
    <div class="bg-white rounded-3xl shadow-2xl px-8 py-10 mb-10 border border-blue-100">
      <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-700 mb-2 text-center">JEE College Predictor</h1>
      <p class="text-gray-600 text-center mb-6 text-lg">Enter your details below to discover colleges that match your JEE rank, category, and preferences. Get instant, data-driven predictions for 2024 admissions.</p>
      <% if (locals.errors && errors.length > 0) { %>
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6 text-center">
          <ul class="list-disc list-inside">
            <% errors.forEach(error => { %>
              <li><%= error %></li>
            <% }); %>
          </ul>
        </div>
      <% } %>
      <form action="/predict" method="POST" class="space-y-6">
        <div>
          <label for="crlRank" class="font-semibold">Your CRL Rank:</label>
          <input type="number" id="crlRank" name="crlRank" required value="<%= locals.inputData ? inputData.crlRank : '' %>" placeholder="e.g., 15000" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1" />
        </div>
        <div>
          <label for="category" class="font-semibold">Category:</label>
          <select id="category" name="category" required onchange="toggleCategoryRank()" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Category</option>
            <option value="GEN" <%= inputData?.category === 'GEN' ? 'selected' : '' %>>General</option>
            <option value="EWS" <%= inputData?.category === 'EWS' ? 'selected' : '' %>>EWS</option>
            <option value="OBC-NCL" <%= inputData?.category === 'OBC-NCL' ? 'selected' : '' %>>OBC-NCL</option>
            <option value="SC" <%= inputData?.category === 'SC' ? 'selected' : '' %>>SC</option>
            <option value="ST" <%= inputData?.category === 'ST' ? 'selected' : '' %>>ST</option>
          </select>
        </div>
        <div id="categoryRankGroup" style="display: <%= (inputData?.category !== 'GEN' && inputData?.category !== '') ? 'block' : 'none' %>;">
          <label for="categoryRank" class="font-semibold">Category Rank:</label>
          <input type="number" id="categoryRank" name="categoryRank" value="<%= inputData?.categoryRank || '' %>" placeholder="Your Category Rank (if applicable)" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1" />
        </div>
        <div>
          <label for="homeStateStatus" class="font-semibold">Home State Quota?</label>
          <select id="homeStateStatus" name="homeStateStatus" required onchange="toggleHomeState()" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Option</option>
            <option value="yes" <%= inputData?.homeStateStatus === 'yes' ? 'selected' : '' %>>Yes</option>
            <option value="no" <%= inputData?.homeStateStatus === 'no' ? 'selected' : '' %>>No</option>
          </select>
        </div>
        <div id="homeStateSelectGroup" style="display: <%= inputData?.homeStateStatus === 'yes' ? 'block' : 'none' %>;">
          <label for="homeState" class="font-semibold">Home State:</label>
          <select id="homeState" name="homeState" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Your State</option>
            <% ['Andhra Pradesh','Bihar','Delhi','Gujarat','Haryana','Karnataka','Madhya Pradesh','Maharashtra','Punjab','Rajasthan','Tamil Nadu','Telangana','Uttar Pradesh','West Bengal','Others'].forEach(state => { %>
              <option value="<%= state %>" <%= inputData?.homeState === state ? 'selected' : '' %>><%= state %></option>
            <% }); %>
          </select>
        </div>
        <div>
          <label for="gender" class="font-semibold">Gender:</label>
          <select id="gender" name="gender" required class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Gender</option>
            <option value="male" <%= inputData?.gender === 'male' ? 'selected' : '' %>>Male</option>
            <option value="female" <%= inputData?.gender === 'female' ? 'selected' : '' %>>Female</option>
          </select>
        </div>
        <div>
          <label for="counsellingType" class="font-semibold">Counselling Type:</label>
          <select id="counsellingType" name="counsellingType" required class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Type</option>
            <option value="JOSAA" <%= inputData?.counsellingType === 'JOSAA' ? 'selected' : '' %>>JoSAA</option>
            <option value="CSAB" <%= inputData?.counsellingType === 'CSAB' ? 'selected' : '' %>>CSAB</option>
          </select>
        </div>
        <div>
          <label for="pwdStatus" class="font-semibold">PwD Status:</label>
          <select id="pwdStatus" name="pwdStatus" required onchange="togglePwdRank()" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1">
            <option value="">Select Option</option>
            <option value="yes" <%= inputData?.pwdStatus === 'yes' ? 'selected' : '' %>>Yes</option>
            <option value="no" <%= inputData?.pwdStatus === 'no' ? 'selected' : '' %>>No</option>
          </select>
        </div>
        <div id="pwdRankGroup" style="display: <%= inputData?.pwdStatus === 'yes' ? 'block' : 'none' %>;">
          <label for="pwdRank" class="font-semibold">PwD Rank:</label>
          <input type="number" id="pwdRank" name="pwdRank" value="<%= inputData?.pwdRank || '' %>" placeholder="Your PwD Rank (if applicable)" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:ring-2 focus:ring-blue-400 focus:outline-none mt-1" />
        </div>
        <button type="submit" id="submitBtn" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl shadow-lg hover:bg-blue-700 transition-all text-lg mt-2">Predict Colleges</button>
      </form>
    </div>

    <% if (locals.predictionResult) { %>
      <section class="bg-white rounded-3xl shadow-xl px-6 py-8 mb-10 border border-blue-100">
        <h2 class="text-2xl font-bold text-blue-800 mb-4 text-center">Prediction Results</h2>
        <% if (typeof predictionResult === 'string') { %>
          <p class="text-center text-gray-700 text-lg"><%= predictionResult %></p>
        <% } else if (predictionResult.length > 0) { %>
          <div class="overflow-x-auto">
            <table class="min-w-full bg-white rounded-xl shadow-lg">
              <thead>
                <tr class="bg-blue-100">
                  <th class="py-3 px-4 text-left font-bold text-blue-700">Institute</th>
                  <th class="py-3 px-4 text-left font-bold text-blue-700">Branch</th>
                  <th class="py-3 px-4 text-left font-bold text-blue-700">Closing Rank</th>
                  <th class="py-3 px-4 text-left font-bold text-blue-700">Counselling</th>
                </tr>
              </thead>
              <tbody>
                <% predictionResult.forEach(college => { %>
                  <tr class="hover:bg-blue-50 transition">
                    <td class="py-2 px-4"><a href="/colleges/read?name=<%= encodeURIComponent(college.instituteName) %>" target="_blank" class="text-blue-600 hover:underline font-semibold"><%= college.instituteName %></a></td>
                    <td class="py-2 px-4"><span class="inline-block bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium"><%= college.branch %></span></td>
                    <td class="py-2 px-4"><span class="inline-block bg-green-100 text-green-700 px-3 py-1 rounded-full text-sm font-semibold"><%= college.closingRank %></span></td>
                    <td class="py-2 px-4"><span class="inline-block bg-yellow-100 text-yellow-700 px-3 py-1 rounded-full text-sm font-semibold"><%= college.counsellingType %></span></td>
                  </tr>
                <% }); %>
              </tbody>
            </table>
          </div>
        <% } else { %>
          <p class="text-center text-gray-700 text-lg">No colleges found for your input. Try adjusting your criteria!</p>
        <% } %>
      </section>
    <% } %>
  </main>

  <!-- How It Works Section -->
  <section class="max-w-4xl mx-auto mt-16 mb-12 px-4">
    <h2 class="text-2xl font-bold text-blue-800 text-center mb-8">How Our Predictor Works</h2>
    <div class="grid md:grid-cols-4 gap-6">
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-blue-500">
        <div class="text-3xl mb-2">🎯</div>
        <h4 class="font-semibold text-lg mb-2">Enter Your Rank</h4>
        <p class="text-gray-600 text-sm">Use your All India Rank or Percentile for accurate prediction.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-blue-500">
        <div class="text-3xl mb-2">🧑‍🎓</div>
        <h4 class="font-semibold text-lg mb-2">Select Category & State</h4>
        <p class="text-gray-600 text-sm">Reservation and quota policies are applied for you.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-blue-500">
        <div class="text-3xl mb-2">🗂️</div>
        <h4 class="font-semibold text-lg mb-2">Pick Counselling</h4>
        <p class="text-gray-600 text-sm">Choose JoSAA or CSAB to match the right college list.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-blue-500">
        <div class="text-3xl mb-2">🏆</div>
        <h4 class="font-semibold text-lg mb-2">See Your Results</h4>
        <p class="text-gray-600 text-sm">We show matching colleges from 2024 closing ranks.</p>
      </div>
    </div>
  </section>

  <!-- Testimonials Section -->
  <section class="max-w-4xl mx-auto mb-16 px-4">
    <h2 class="text-2xl font-bold text-blue-800 text-center mb-8">What Students Say</h2>
    <div class="grid md:grid-cols-3 gap-6">
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-green-400">
        <div class="text-3xl mb-2">🌟</div>
        <p class="text-gray-700 italic mb-2">"The predictions were spot on! Helped me shortlist my dream colleges easily."</p>
        <div class="font-semibold text-blue-700">Amit, JEE 2023 Aspirant</div>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-green-400">
        <div class="text-3xl mb-2">🌟</div>
        <p class="text-gray-700 italic mb-2">"Super easy to use and the results matched my actual allotment!"</p>
        <div class="font-semibold text-blue-700">Priya, NIT Student</div>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-green-400">
        <div class="text-3xl mb-2">🌟</div>
        <p class="text-gray-700 italic mb-2">"Loved the clean interface and instant results. Highly recommended!"</p>
        <div class="font-semibold text-blue-700">Rahul, IIIT Hyderabad</div>
      </div>
    </div>
  </section>

  <!-- Understanding Your Results Section -->
  <section class="max-w-3xl mx-auto px-4 py-12">
    <h2 class="text-2xl font-bold text-blue-800 text-center mb-8">Understanding Your Results</h2>
    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-blue-500">
        <h4 class="font-semibold text-lg mb-2">What is Closing Rank?</h4>
        <p class="text-gray-600 text-sm">The closing rank is the rank of the last student admitted to a particular branch and college in the previous year. It helps you estimate your chances for the current year.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-green-500">
        <h4 class="font-semibold text-lg mb-2">How to Use the List</h4>
        <p class="text-gray-600 text-sm">Colleges where your rank is better than the closing rank are likely options. Use this list to prioritize your choices during counseling.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-yellow-500">
        <h4 class="font-semibold text-lg mb-2">Consider Variations</h4>
        <p class="text-gray-600 text-sm">Closing ranks can change each year due to competition and seat matrix changes. Always keep a buffer and consider a range of options.</p>
      </div>
      <div class="bg-white p-6 rounded-xl shadow text-center border-t-4 border-purple-500">
        <h4 class="font-semibold text-lg mb-2">Next Steps</h4>
        <p class="text-gray-600 text-sm">Research your shortlisted colleges, visit their official websites, and prepare your documents for the counseling process.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-8 mt-12">
    <div class="max-w-7xl mx-auto px-4 grid md:grid-cols-4 gap-4">
      <div>
        <h4 class="text-lg font-bold mb-2">RankToCollege</h4>
        <p>Helping students make better college decisions with accurate predictions.</p>
      </div>
      <div>
        <h4 class="font-semibold mb-2">Quick Links</h4>
        <ul>
          <li><a href="/" class="hover:underline">Home</a></li>
          <li><a href="/predict" class="hover:underline">Predict</a></li>
          <li><a href="/contact" class="hover:underline">Contact</a></li>
        </ul>
      </div>
      <div>
        <h4 class="font-semibold mb-2">Counselling Authorities</h4>
        <ul>
          <li>JoSAA</li>
          <li>JAC Delhi</li>
          <li>WBJEE</li>
          <li>COMEDK</li>
        </ul>
      </div>
      <div>
        <h4 class="font-semibold mb-2">Policies</h4>
        <ul>
          <li><a href="/privacy-policy" class="hover:underline">Privacy Policy</a></li>
          <li><a href="/terms-and-conditions" class="hover:underline">Terms & Conditions</a></li>
        </ul>
      </div>
    </div>
    <div class="text-center mt-6 text-sm text-gray-300">
      &copy; 2025 RankToCollege. All rights reserved.
    </div>
  </footer>
  <script>
    function toggleCategoryRank() {
      const cat = document.getElementById('category').value;
      const group = document.getElementById('categoryRankGroup');
      if (cat && cat !== 'GEN') {
        group.style.display = 'block';
        document.getElementById('categoryRank').setAttribute('required', 'required');
      } else {
        group.style.display = 'none';
        document.getElementById('categoryRank').removeAttribute('required');
        document.getElementById('categoryRank').value = '';
      }
    }
    function togglePwdRank() {
      const val = document.getElementById('pwdStatus').value;
      const group = document.getElementById('pwdRankGroup');
      if (val === 'yes') {
        group.style.display = 'block';
        document.getElementById('pwdRank').setAttribute('required', 'required');
      } else {
        group.style.display = 'none';
        document.getElementById('pwdRank').removeAttribute('required');
        document.getElementById('pwdRank').value = '';
      }
    }
    function toggleHomeState() {
      const val = document.getElementById('homeStateStatus').value;
      const group = document.getElementById('homeStateSelectGroup');
      const select = document.getElementById('homeState');
      if (val === 'yes') {
        group.style.display = 'block';
        select.setAttribute('required', 'required');
      } else {
        group.style.display = 'none';
        select.removeAttribute('required');
        select.value = '';
      }
    }
    window.onload = function () {
      toggleCategoryRank();
      togglePwdRank();
      toggleHomeState();
      // FAQ expand/collapse
      document.querySelectorAll('.faq-item').forEach(item => {
        item.addEventListener('click', function() {
          this.classList.toggle('open');
        });
      });
    };
    document.querySelector('form').addEventListener('submit', function () {
      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.innerText = 'Predicting...';
    });
  </script>
</body>
</html>